<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Seguimiento de Pedido - Miski Chukulati</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body{font-family:"Poppins",Arial,sans-serif;background:#f8f3ef;color:#3e2723;padding:24px}
    .container{max-width:700px;margin:20px auto;background:#fff;padding:22px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.06)}
    h2{text-align:center;color:#4e342e}
    input{width:100%;padding:10px;border-radius:8px;border:1px solid #e0d7d3}
    button{margin-top:12px;padding:10px;width:100%;background:#6b3e26;color:#fff;border:none;border-radius:8px;cursor:pointer}
    .result{margin-top:16px;padding:12px;background:#faf6f2;border-radius:8px}
    a.btn{display:inline-block;padding:10px 14px;background:#6b3e26;color:#fff;border-radius:8px;text-decoration:none;margin-top:10px}
  </style>
</head>
<body>
  <div class="container">
    <h2>Seguimiento de Pedido</h2>
    <label for="idPedido">ID de pedido (Ej: P20251005123045) o DNI:</label>
    <input id="idPedido" placeholder="Ingresa ID o DNI">
    <button onclick="buscar()">Buscar pedido</button>
    <div id="resultado" class="result" style="display:none"></div>
  </div>

<script>
  const webApp = "https://script.google.com/macros/s/AKfycbxCfLo3-45HrYp8S4qpQSdwvCQW4Q6Uzg_Q_du64qu5GJ-F9ijny1hLd3Llwmda_zkXSQ/exec";
  async function buscar(){
    const q = document.getElementById('idPedido').value.trim();
    if(!q) return alert('Ingresa ID o DNI');
    const isId = q.startsWith('P');
    const url = `${webApp}?action=trackOrder&${isId? 'idPedido=' + encodeURIComponent(q) : 'dni=' + encodeURIComponent(q)}`;
    try {
      const r = await fetch(url);
      const html = await r.text();
      // doGet returns an HTML page rendered by Apps Script — abrir en nueva pestaña es mejor:
      // Abrir la página servida por el WebApp (seguimiento)
      window.open(url, '_blank');
    } catch (err) {
      document.getElementById('resultado').style.display = 'block';
      document.getElementById('resultado').textContent = 'Error al consultar. Intenta de nuevo.';
      console.error(err);
    }
  }
</script>
</body>
</html>
