<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Haz tu Pedido - Miski Chukulati</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet">
<style>
body{font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#3b2314,#5c3b1e,#7b4c22);color:#fff;margin:0;padding:0}
header{padding:12px 24px;background:rgba(0,0,0,0.5);display:flex;justify-content:space-between;align-items:center}
header h1{margin:0;font-size:1.5em}
.menu-btn{font-size:1.5em;cursor:pointer}
nav{position:absolute;top:50px;right:0;background:rgba(0,0,0,0.85);width:220px;display:none;flex-direction:column;border-radius:8px;margin:8px}
nav a{padding:12px 16px;color:#fff;text-decoration:none;border-bottom:1px solid #d4c5b2}
nav a:last-child{border-bottom:none}
nav a:hover{background:rgba(255,255,255,0.1)}
.container{max-width:600px;margin:36px auto;background:rgba(255,255,255,0.08);padding:24px;border-radius:12px}
label{display:block;margin-top:10px;font-weight:600}
input,select,textarea,button{padding:10px;border-radius:8px;border:1px solid #d4c5b2;width:100%;box-sizing:border-box;margin-top:4px}
textarea{resize:vertical}
.result{margin-top:18px;background:rgba(255,255,255,0.05);padding:12px;border-radius:8px}
.total-box{background:rgba(255,255,255,0.1);padding:12px;border-radius:8px;margin-top:12px;font-weight:700}
button{background:linear-gradient(90deg,#c7a86d,#e5c99c);color:#3b2314;font-weight:700;border:none;cursor:pointer}
button:hover{opacity:0.9}
</style>
</head>
<body>

<header>
<h1>Miski Chukulati üç´</h1>
<div class="menu-btn" onclick="toggleMenu()">‚ò∞</div>
<nav id="menuNav">
  <a href="#" onclick="showPedido()">Hacer Pedido</a>
  <a href="#" onclick="showOracion()">Pedido de Oraci√≥n</a>
</nav>
</header>

<div class="container" id="pedidoForm">
  <h2>Hacer Pedido</h2>

  <label>Nombre Completo</label>
  <input id="nombre" placeholder="Juan P√©rez">

  <label>DNI</label>
  <input id="dni" placeholder="8 d√≠gitos">

  <label>Correo</label>
  <input id="correo" type="email" placeholder="correo@ejemplo.com">

  <label>Celular</label>
  <input id="telefono" placeholder="9 d√≠gitos">

  <label>Producto</label>
  <select id="producto" onchange="calcularTotal()">
    <option value="">--Selecciona--</option>
    <option value="Tableta 70 % cacao">Tableta 70 % cacao</option>
    <option value="Tableta 85 % cacao">Tableta 85 % cacao</option>
    <option value="Bombones surtidos">Bombones surtidos</option>
    <option value="Dark Chocolate Bar">Dark Chocolate Bar</option>
    <option value="ChocoNibs">ChocoNibs</option>
    <option value="ChocoBites">ChocoBites</option>
    <option value="Chocolate Blanco">Chocolate Blanco</option>
  </select>

  <label>Cantidad</label>
  <input id="cantidad" type="number" min="1" value="1" onchange="calcularTotal()">

  <label>M√©todo de Pago</label>
  <select id="metodoPago">
    <option value="PLIN">PLIN</option>
    <option value="YAPE">YAPE</option>
    <option value="Transferencia">Transferencia</option>
    <option value="Efectivo">Efectivo</option>
  </select>

  <label>Encargado de Env√≠o</label>
  <select id="encargadoEnvio">
    <option value="Courier1">Courier1</option>
    <option value="Courier2">Courier2</option>
    <option value="Courier3">Courier3</option>
  </select>

  <label>Comentarios</label>
  <textarea id="comentarios" placeholder="Opcional"></textarea>

  <div class="total-box">
    <div>Base Imponible: S/ <span id="baseImponible">0.00</span></div>
    <div>IGV (18%): S/ <span id="igv">0.00</span></div>
    <div>Comisi√≥n env√≠o: S/ <span id="envio">7.00</span></div>
    <div>Total a pagar por tu pedido: S/ <span id="total">0.00</span></div>
  </div>

  <button onclick="enviarPedido()">Enviar Pedido</button>
  <div id="result" class="result" style="display:none"></div>
</div>

<div class="container" id="oracionForm" style="display:none">
  <h2>Pedido de Oraci√≥n</h2>
  <label>Nombre Completo</label>
  <input id="nombreOracion" placeholder="Juan P√©rez">

  <label>Pedido de Oraci√≥n</label>
  <textarea id="pedidoOracion" placeholder="Escribe tu pedido de oraci√≥n"></textarea>

  <label>Orar Por</label>
  <input id="orarPor" placeholder="Por qui√©n deseas orar">

  <button onclick="enviarOracion()">Enviar Pedido de Oraci√≥n</button>
  <div id="resultOracion" class="result" style="display:none"></div>
</div>

<script>
const SCRIPT_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzjkZePM6u1C5mWYEzuFSBNBhWjM-DNaYI56LHOSMU3Hxk3CaSAm8pPn0gtMkXTb5cx/exec";
const productosPrecios = {
  "Tableta 70 % cacao": 8.00,
  "Tableta 85 % cacao": 9.00,
  "Bombones surtidos": 15.00,
  "Dark Chocolate Bar": 8.00,
  "ChocoNibs": 5.00,
  "ChocoBites": 6.50,
  "Chocolate Blanco": 24.00
};
const envioFijo = 7;

function toggleMenu(){const nav=document.getElementById('menuNav');nav.style.display=(nav.style.display==='flex')?'none':'flex';}

function showPedido(){document.getElementById('pedidoForm').style.display='block';document.getElementById('oracionForm').style.display='none';}
function showOracion(){document.getElementById('pedidoForm').style.display='none';document.getElementById('oracionForm').style.display='block';}

function calcularTotal(){
  const producto = document.getElementById('producto').value;
  const cantidad = Number(document.getElementById('cantidad').value || 1);
  const precioUnitario = productosPrecios[producto] || 0;
  const base = precioUnitario * cantidad;
  const igv = parseFloat((base*0.18).toFixed(2));
  const total = parseFloat((base + igv + envioFijo).toFixed(2));

  document.getElementById('baseImponible').innerText = base.toFixed(2);
  document.getElementById('igv').innerText = igv.toFixed(2);
  document.getElementById('envio').innerText = envioFijo.toFixed(2);
  document.getElementById('total').innerText = total.toFixed(2);
}

async function enviarPedido(){
  const data = {
    type: "pedido",
    nombre: document.getElementById('nombre').value.trim(),
    dni: document.getElementById('dni').value.trim(),
    correo: document.getElementById('correo').value.trim(),
    telefono: document.getElementById('telefono').value.trim(),
    producto: document.getElementById('producto').value,
    cantidad: Number(document.getElementById('cantidad').value || 1),
    metodoPago: document.getElementById('metodoPago').value,
    encargadoEnvio: document.getElementById('encargadoEnvio').value,
    comentarios: document.getElementById('comentarios').value.trim(),
    envio: envioFijo
  };
  document.getElementById('result').style.display='block';
  document.getElementById('result').innerText='Enviando pedido...';
  try{
    const res = await fetch(SCRIPT_WEB_APP_URL,{method:'POST',body:JSON.stringify(data)});
    const json = await res.json();
    if(json.success){
      document.getElementById('result').innerText='Gracias por tu compra...!, Que Dios te gu√≠e y guarde siempre...!';
      document.getElementById('pedidoForm').reset();
      calcularTotal();
    } else {
      document.getElementById('result').innerText='Error: '+json.error;
    }
  }catch(err){
    console.error(err);
    document.getElementById('result').innerText='Error al enviar pedido.';
  }
}

async function enviarOracion(){
  const data = {
    type: "prayer",
    nombre: document.getElementById('nombreOracion').value.trim(),
    pedido: document.getElementById('pedidoOracion').value.trim(),
    orarPor: document.getElementById('orarPor').value.trim()
  };
  document.getElementById('resultOracion').style.display='block';
  document.getElementById('resultOracion').innerText='Enviando pedido de oraci√≥n...';
  try{
    const res = await fetch(SCRIPT_WEB_APP_URL,{method:'POST',body:JSON.stringify(data)});
    const json = await res.json();
    if(json.success){
      document.getElementById('resultOracion').innerText='¬°Pedido de oraci√≥n enviado correctamente!';
      document.getElementById('oracionForm').reset();
    } else {
      document.getElementById('resultOracion').innerText='Error: '+json.error;
    }
  }catch(err){
    console.error(err);
    document.getElementById('resultOracion').innerText='Error al enviar pedido de oraci√≥n.';
  }
}

calcularTotal();
</script>

</body>
</html>
