<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Haz tu Pedido | Miski Chukulati</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet">
<style>
body {
  font-family:'Poppins',sans-serif;
  background:#fff8f0;
  color:#5c4033;
  margin:0;
}
.container {
  max-width:600px;
  margin:60px auto;
  background:#fff;
  padding:30px 40px;
  border-radius:12px;
  box-shadow:0 0 15px rgba(92,64,51,0.1);
  text-align:center;
}
.container img {
  width:100px;
  border-radius:50%;
  margin-bottom:10px;
}
h1 {text-align:center;color:#5c4033;}
label {font-weight:500;display:block;margin-top:15px;text-align:left;}
input,select,textarea {
  width:100%;padding:10px;margin-top:5px;
  border:1px solid #d4c5b2;border-radius:6px;
}
button {
  margin-top:25px;width:100%;
  background:linear-gradient(90deg,#c7a86d,#e5c99c);
  color:#5c4033;border:none;padding:12px;font-size:1.1rem;
  border-radius:30px;cursor:pointer;transition:0.3s;
}
button:hover {transform:scale(1.05);}
.message{text-align:center;margin-top:20px;}
.success{color:green;} .error{color:red;}
footer{text-align:center;margin-top:40px;font-size:.9rem;color:#7b5b4a;}
.total {margin-top:15px;font-weight:600;color:#4b2e05;}
</style>
</head>
<body>
<div class="container">
  <img src="https://i.ibb.co/ScVhT9F/logo-redondo.png" alt="Miski Logo">
  <h1>Haz tu Pedido</h1>
  <form id="pedidoForm">
    <label>DNI</label><input type="text" name="dni" required maxlength="8">
    <label>Nombre Completo</label><input type="text" name="nombre" required>
    <label>Correo</label><input type="email" name="correo" required>
    <label>Teléfono / Celular</label><input type="tel" name="telefono" required>
    <label>Producto</label>
    <select name="producto" id="producto" required>
      <option value="">Selecciona un producto</option>
      <option value="Tableta 70%">Tableta 70 % cacao</option>
      <option value="Tableta 85%">Tableta 85 % cacao</option>
      <option value="Bombones">Bombones surtidos</option>
      <option value="Dark">Dark Chocolate Bar</option>
      <option value="ChocoNibs">ChocoNibs</option>
      <option value="ChocoBites">ChocoBites</option>
      <option value="Blanco">Chocolate Blanco</option>
    </select>
    <label>Cantidad</label><input type="number" id="cantidad" name="cantidad" min="1" value="1" required>
    <label>Dirección</label><input type="text" name="direccion">
    <label>Comentarios</label><textarea name="comentarios" rows="3"></textarea>
    <div class="total" id="total"></div>
    <button type="submit">Enviar pedido</button>
  </form>
  <div id="msg" class="message"></div>
</div>
<footer>
  <p><strong>Números 6:24</strong> “Jehová te bendiga y te guarde.”</p>
</footer>

<script>
const scriptURL="https://script.google.com/macros/s/AKfycbypicbViQpx68de35No3yAEd2XoLHOQ5banZ8cmJjn15es3eus8K4rTM8sRtFoPaDiH/exec";
const form=document.getElementById("pedidoForm");
const msg=document.getElementById("msg");
const totalDiv=document.getElementById("total");

const precios = {
  "Tableta 70%": 10,
  "Tableta 85%": 12,
  "Bombones": 15,
  "Dark": 13,
  "ChocoNibs": 11,
  "ChocoBites": 9,
  "Blanco": 10
};
const comisionEnvio = 7;

function calcularTotal(){
  const producto = document.getElementById("producto").value;
  const cantidad = parseInt(document.getElementById("cantidad").value || 1);
  if(precios[producto]){
    const subtotal = precios[producto] * cantidad;
    const total = subtotal + comisionEnvio;
    totalDiv.innerHTML = `El total a pagar por tu pedido es: <strong>S/ ${total}</strong><br>(Base imponible: S/ ${(subtotal/1.18).toFixed(2)}, IGV: S/ ${(subtotal - subtotal/1.18).toFixed(2)}, Envío: S/ ${comisionEnvio})`;
  } else {
    totalDiv.innerHTML = "";
  }
}
document.getElementById("producto").addEventListener("change", calcularTotal);
document.getElementById("cantidad").addEventListener("input", calcularTotal);

form.addEventListener("submit",e=>{
  e.preventDefault();
  msg.textContent="Enviando...";
  fetch(scriptURL,{method:"POST",body:new FormData(form)})
  .then(r=>{
    if(!r.ok) throw new Error("Error al enviar");
    msg.innerHTML=`<span class="success">✅ Pedido registrado.</span><br>Gracias por tu compra...!<br>Que Dios te guíe y guarde siempre...!`;
    form.reset();
    totalDiv.innerHTML="";
  })
  .catch(()=>msg.innerHTML='<span class="error">Error de conexión.</span>');
});
</script>
</body>
</html>
