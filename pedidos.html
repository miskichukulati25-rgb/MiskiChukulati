<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hacer Pedido | Miski Chukulati üç´</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg1:#3b2314; --bg2:#5c3b1e; --bg3:#7b4c22;
  --gold:#d4af37; --gold-soft:#f7e7ce;
}

body {
  margin:0;
  font-family:'Montserrat',sans-serif;
  background:linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
  background-size:400% 400%;
  animation:bgShift 15s ease infinite;
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
}
@keyframes bgShift {
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

.container {
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(6px);
  padding:30px 40px;
  border-radius:16px;
  box-shadow:0 0 25px rgba(0,0,0,0.3);
  max-width:620px;
  width:90%;
  text-align:left;
}

.logo {
  display:block;
  margin:0 auto 15px;
  width:120px;
  height:120px;
  border-radius:50%;
  box-shadow:0 0 20px rgba(212,175,55,0.4);
}

h1 {
  text-align:center;
  color:var(--gold-soft);
  margin-bottom:10px;
}

label {
  display:block;
  margin-top:12px;
  color:var(--gold-soft);
  font-weight:600;
}
input, select, textarea {
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:8px;
  border:1px solid rgba(212,175,55,0.3);
  background:rgba(255,255,255,0.1);
  color:#fff;
  font-family:inherit;
}
input:focus, select:focus, textarea:focus {
  outline:none;
  border-color:var(--gold);
}

button {
  margin-top:25px;
  width:100%;
  background:linear-gradient(90deg,#a67c52,#d4af37,#a67c52);
  background-size:200% 100%;
  color:#fff;
  font-weight:700;
  font-size:1rem;
  padding:12px;
  border:none;
  border-radius:30px;
  cursor:pointer;
  transition:transform 0.3s ease, box-shadow 0.3s ease;
}
button:hover {
  transform:scale(1.05);
  box-shadow:0 6px 18px rgba(212,175,55,0.6);
}

.total {
  margin-top:18px;
  background:rgba(255,255,255,0.08);
  padding:12px;
  border-radius:10px;
  text-align:center;
  color:#f7e7ce;
  font-weight:600;
}

.message {
  text-align:center;
  margin-top:20px;
  font-weight:600;
}
.success{color:#00ff99;}
.error{color:#ff6666;}

.back-link {
  display:inline-block;
  margin-top:25px;
  text-decoration:none;
  color:var(--gold);
  font-weight:600;
  text-align:center;
  width:100%;
}

footer {
  text-align:center;
  color:#e0c68b;
  margin-top:30px;
  font-size:0.9rem;
}
</style>
</head>
<body>

<div class="container">
  <img src="https://github.com/miskichukulati25-rgb/MiskiChukulati/blob/main/logo.png?raw=true" alt="Logo" class="logo">
  <h1>Haz tu Pedido</h1>

  <form id="pedidoForm">
    <label for="dni">DNI</label>
    <input type="text" id="dni" name="dni" maxlength="8" required>

    <label for="nombre">Nombre Completo</label>
    <input type="text" id="nombre" name="nombre" required>

    <label for="correo">Correo</label>
    <input type="email" id="correo" name="correo" required>

    <label for="telefono">Celular</label>
    <input type="tel" id="telefono" name="telefono" required>

    <label for="producto">Producto</label>
    <select id="producto" name="producto" required>
      <option value="">Selecciona un producto</option>
      <option data-precio="10">Tableta 70 % cacao</option>
      <option data-precio="12">Tableta 85 % cacao</option>
      <option data-precio="15">Bombones surtidos</option>
      <option data-precio="14">Dark Chocolate Bar</option>
      <option data-precio="11">ChocoNibs</option>
      <option data-precio="9">ChocoBites</option>
      <option data-precio="10">Chocolate Blanco</option>
    </select>

    <label for="cantidad">Cantidad</label>
    <input type="number" id="cantidad" name="cantidad" min="1" value="1" required>

    <label for="direccion">Direcci√≥n</label>
    <input type="text" id="direccion" name="direccion">

    <label for="comentarios">Comentarios</label>
    <textarea id="comentarios" name="comentarios" rows="3"></textarea>

    <div class="total" id="resumen">
      üí∞ <b>Total estimado:</b> S/ 0.00<br>
      (Base: S/ 0.00 | IGV: S/ 0.00 | Env√≠o: S/ 7.00)
    </div>

    <button type="submit">Enviar Pedido</button>
  </form>

  <div id="msg" class="message"></div>

  <a href="index.html" class="back-link">‚¨Ö Volver al inicio</a>
</div>

<footer>
  <p><strong>N√∫meros 6:24</strong> ‚ÄúJehov√° te bendiga y te guarde‚Äù</p>
  <p>¬© Miski Chukulati - 2025</p>
</footer>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbzf8ItcHW5XfN93jmnwacmwXOuc9Xgac2aHdO4s4_fZ7ddQBnU3hQtfNUFxkpii5psr/exec";
const form = document.getElementById("pedidoForm");
const msg = document.getElementById("msg");
const resumen = document.getElementById("resumen");
const envioFijo = 7.00; // editable por administrador

function actualizarTotal() {
  const producto = document.getElementById("producto");
  const cantidad = parseInt(document.getElementById("cantidad").value) || 1;
  const precioUnit = parseFloat(producto.options[producto.selectedIndex]?.dataset.precio || 0);
  const subtotal = precioUnit * cantidad;
  const igv = subtotal * 0.18;
  const total = subtotal + igv + envioFijo;

  resumen.innerHTML = `üí∞ <b>Total estimado:</b> S/ ${total.toFixed(2)}<br>
  (Base: S/ ${subtotal.toFixed(2)} | IGV: S/ ${igv.toFixed(2)} | Env√≠o: S/ ${envioFijo.toFixed(2)})`;
}

document.getElementById("producto").addEventListener("change", actualizarTotal);
document.getElementById("cantidad").addEventListener("input", actualizarTotal);

form.addEventListener("submit", e => {
  e.preventDefault();
  msg.textContent = "‚è≥ Enviando tu pedido...";
  fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(Object.fromEntries(new FormData(form))),
    headers: { "Content-Type": "application/json" }
  })
  .then(r => r.json())
  .then(d => {
    if (d.success) {
      msg.innerHTML = `<span class="success">‚úÖ Pedido ${d.idPedido} registrado.</span><br>
      Revisa tu correo para el comprobante.<br><br>
      Gracias por tu compra...!<br>
      Que Dios te gu√≠e y guarde siempre...! üôè`;
      form.reset();
      resumen.innerHTML = "üí∞ <b>Total estimado:</b> S/ 0.00<br>(Base: S/ 0.00 | IGV: S/ 0.00 | Env√≠o: S/ 7.00)";
    } else {
      msg.innerHTML = `<span class="error">‚ùå ${d.error || 'Error al registrar el pedido.'}</span>`;
    }
  })
  .catch(() => msg.innerHTML = '<span class="error">Error de conexi√≥n.</span>');
});
</script>
</body>
</html>
