<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Haz tu Pedido - Miski Chukulati</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet">
<style>
body{
  font-family:'Poppins',sans-serif;
  background:linear-gradient(135deg,#3b2314,#5c3b1e,#7b4c22);
  color:#fff;margin:0;padding:0;
}
header{
  padding:12px 24px;
  background:rgba(0,0,0,0.5);
  display:flex;justify-content:space-between;align-items:center;
}
.logo{
  width:70px;height:70px;
  border-radius:50%;
  box-shadow:0 0 15px rgba(212,175,55,0.5);
  transition:transform 0.3s ease, box-shadow 0.3s ease;
}
.logo:hover{
  transform:scale(1.05);
  box-shadow:0 0 25px rgba(212,175,55,0.8);
}
.menu-btn{font-size:1.5em;cursor:pointer}
nav{
  position:absolute;top:80px;right:0;
  background:rgba(0,0,0,0.9);
  width:230px;display:none;flex-direction:column;border-radius:10px;
}
nav a{
  padding:12px 16px;color:#fff;text-decoration:none;border-bottom:1px solid #d4c5b2;
}
nav a:last-child{border-bottom:none}
nav a:hover{background:rgba(255,255,255,0.1)}
.container{
  max-width:600px;margin:36px auto;
  background:rgba(255,255,255,0.08);
  padding:24px;border-radius:12px;text-align:left;
}
label{display:block;margin-top:10px;font-weight:600}
input,select,textarea,button{
  padding:10px;border-radius:8px;
  border:1px solid #d4c5b2;width:100%;
  box-sizing:border-box;margin-top:4px;
}
textarea{resize:vertical}
.result{
  margin-top:18px;background:rgba(255,255,255,0.05);
  padding:12px;border-radius:8px;
}
button{
  background:linear-gradient(90deg,#c7a86d,#e5c99c);
  color:#3b2314;font-weight:700;border:none;cursor:pointer;
  transition:0.3s;
}
button:hover{opacity:0.9;transform:scale(1.03)}

/* POPUP */
.popup-overlay{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;
  animation: fadeInOverlay 0.4s ease forwards;
}
@keyframes fadeInOverlay{
  from{opacity:0;} to{opacity:1;}
}
.popup{
  background:#fff8f0;color:#3b2314;
  padding:25px 35px;border-radius:15px;max-width:340px;
  text-align:center;box-shadow:0 0 20px rgba(0,0,0,0.4);
  border:2px solid #d4af37;
  transform:scale(0.8);
  animation: zoomInPopup 0.4s ease forwards, goldenGlow 6s linear infinite;
}
@keyframes zoomInPopup{
  from{opacity:0;transform:scale(0.8);}
  to{opacity:1;transform:scale(1);}
}
@keyframes goldenGlow{
  0%{box-shadow:0 0 10px rgba(212,175,55,0.3);}
  50%{box-shadow:0 0 25px rgba(212,175,55,0.7);}
  100%{box-shadow:0 0 10px rgba(212,175,55,0.3);}
}
.popup h3{margin-top:0;color:#7b5b4a}
.popup button{
  margin-top:15px;background:linear-gradient(90deg,#c7a86d,#e5c99c);
  border:none;padding:10px 24px;border-radius:30px;font-weight:600;
  cursor:pointer;
}
.popup button:hover{transform:scale(1.05);}
</style>
</head>
<body>

<header>
  <img src="ea94f829-847c-4e93-8216-1baab28ea466.png" alt="Miski Chukulati Logo" class="logo">
  <div class="menu-btn" onclick="toggleMenu()">☰</div>
  <nav id="menuNav">
    <a href="#" onclick="showPedido()">Hacer Pedido</a>
    <a href="#" onclick="showOracion()">Pedido de Oración</a>
  </nav>
</header>

<div class="container" id="pedidoForm">
  <h2>Hacer Pedido</h2>

  <label>Nombre Completo</label>
  <input id="nombre" placeholder="Juan Pérez">

  <label>DNI</label>
  <input id="dni" placeholder="8 dígitos">

  <label>Correo</label>
  <input id="correo" type="email" placeholder="correo@ejemplo.com">

  <label>Celular</label>
  <input id="telefono" placeholder="9 dígitos">

  <label>Producto</label>
  <select id="producto" onchange="calcularTotal()">
    <option value="">--Selecciona--</option>
    <option value="Tableta 70 % cacao">Tableta 70 % cacao</option>
    <option value="Tableta 85 % cacao">Tableta 85 % cacao</option>
    <option value="Bombones surtidos">Bombones surtidos</option>
    <option value="Dark Chocolate Bar">Dark Chocolate Bar</option>
    <option value="ChocoNibs">ChocoNibs</option>
    <option value="ChocoBites">ChocoBites</option>
    <option value="Chocolate Blanco">Chocolate Blanco</option>
  </select>

  <label>Cantidad</label>
  <input id="cantidad" type="number" min="1" value="1" onchange="calcularTotal()">

  <label>Método de Pago</label>
  <select id="metodoPago">
    <option value="PLIN">PLIN</option>
    <option value="YAPE">YAPE</option>
    <option value="Transferencia">Transferencia</option>
    <option value="Efectivo">Efectivo</option>
  </select>

  <label>Encargado de Envío</label>
  <select id="encargadoEnvio">
    <option value="Courier1">Courier1</option>
    <option value="Courier2">Courier2</option>
    <option value="Courier3">Courier3</option>
  </select>

  <label>Comentarios</label>
  <textarea id="comentarios" placeholder="Opcional"></textarea>

  <button onclick="mostrarPopup()">Ver Total</button>
  <button onclick="enviarPedido()">Enviar Pedido</button>
  <div id="result" class="result" style="display:none"></div>
</div>

<div class="container" id="oracionForm" style="display:none">
  <h2>Pedido de Oración</h2>
  <label>Nombre Completo</label>
  <input id="nombreOracion" placeholder="Juan Pérez">

  <label>Pedido de Oración</label>
  <textarea id="pedidoOracion" placeholder="Escribe tu pedido de oración"></textarea>

  <label>Orar Por</label>
  <input id="orarPor" placeholder="Por quién deseas orar">

  <button onclick="enviarOracion()">Enviar Pedido de Oración</button>
  <div id="resultOracion" class="result" style="display:none"></div>
</div>

<!-- POPUP -->
<div class="popup-overlay" id="popupOverlay">
  <div class="popup">
    <h3>Detalle de tu pedido</h3>
    <p>Precio producto: S/ <span id="pPrecio">0.00</span></p>
    <p>Comisión de envío: S/ <span id="pEnvio">7.00</span></p>
    <hr>
    <h3>Total a pagar: S/ <span id="pTotal">0.00</span></h3>
    <button onclick="cerrarPopup()">Aceptar</button>
  </div>
</div>

<script>
const SCRIPT_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzf8ItcHW5XfN93jmnwacmwXOuc9Xgac2aHdO4s4_fZ7ddQBnU3hQtfNUFxkpii5psr/exec";
const productosPrecios = {
  "Tableta 70 % cacao": 8.00,
  "Tableta 85 % cacao": 9.00,
  "Bombones surtidos": 15.00,
  "Dark Chocolate Bar": 8.00,
  "ChocoNibs": 5.00,
  "ChocoBites": 6.50,
  "Chocolate Blanco": 24.00
};
const envioFijo = 7;

function toggleMenu(){
  const nav=document.getElementById('menuNav');
  nav.style.display=(nav.style.display==='flex')?'none':'flex';
}
function showPedido(){
  document.getElementById('pedidoForm').style.display='block';
  document.getElementById('oracionForm').style.display='none';
}
function showOracion(){
  document.getElementById('pedidoForm').style.display='none';
  document.getElementById('oracionForm').style.display='block';
}
function calcularTotal(){
  const producto=document.getElementById('producto').value;
  const cantidad=Number(document.getElementById('cantidad').value||1);
  const precioUnitario=productosPrecios[producto]||0;
  return (precioUnitario*cantidad)+envioFijo;
}
function mostrarPopup(){
  const producto=document.getElementById('producto').value;
  const cantidad=Number(document.getElementById('cantidad').value||1);
  const precioUnitario=productosPrecios[producto]||0;
  const total=(precioUnitario*cantidad)+envioFijo;
  document.getElementById('pPrecio').innerText=(precioUnitario*cantidad).toFixed(2);
  document.getElementById('pEnvio').innerText=envioFijo.toFixed(2);
  document.getElementById('pTotal').innerText=total.toFixed(2);
  document.getElementById('popupOverlay').style.display='flex';
}
function cerrarPopup(){
  document.getElementById('popupOverlay').style.display='none';
}
async function enviarPedido(){
  const data={
    type:"pedido",
    nombre:document.getElementById('nombre').value.trim(),
    dni:document.getElementById('dni').value.trim(),
    correo:document.getElementById('correo').value.trim(),
    telefono:document.getElementById('telefono').value.trim(),
    producto:document.getElementById('producto').value,
    cantidad:Number(document.getElementById('cantidad').value||1),
    metodoPago:document.getElementById('metodoPago').value,
    encargadoEnvio:document.getElementById('encargadoEnvio').value,
    comentarios:document.getElementById('comentarios').value.trim(),
    envio:envioFijo
  };
  document.getElementById('result').style.display='block';
  document.getElementById('result').innerText='Enviando pedido...';
  try{
    const res=await fetch(SCRIPT_WEB_APP_URL,{method:'POST',body:JSON.stringify(data)});
    const json=await res.json();
    if(json.success){
      document.getElementById('result').innerText='✅ Gracias por tu compra...! Que Dios te guíe y guarde siempre...!';
      setTimeout(()=>{location.reload()},3000);
    }else{
      document.getElementById('result').innerText='Error: '+json.message;
    }
  }catch(err){
    console.error(err);
    document.getElementById('result').innerText='Error al enviar pedido.';
  }
}
</script>
</body>
</html>
